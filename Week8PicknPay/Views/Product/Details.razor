
@page "/product/{id}"

@using Microsoft.AspNetCore.Components.Web
@using Week8PicknPay.Models
@using Week8PicknPay.Repository
@using Week8PicknPay.Components

@inject IProductRepository _productRepository
@inject IShoppingCart _cart

@inherits ProductCart

<div style="display: flex; justify-content: center;">
    <img alt="@product.Name" src="@product.ImageUrl" style="height: 30rem; min-width: 30rem; padding-right:.2rem; margin: 5px 5px 0 5px; ">
</div>
<div class="product-details">
    <div>
        <h3 style="color:crimson">
            @product.Name
        </h3>
        <hr />
        <div style="display:flex">
            <h3>
                @string.Format("# {0:N}", product.Price)
            </h3>
            <div class="addToCart pull-right">
                <div>
                    <button class="product-qty" @onclick="(e =>DecreaseQty())">
                        <i class="fa-solid fa-minus"></i>
                    </button>
                    <p style="font-size: 2.5rem;">@productQty</p>
                    <button class="product-qty" @onclick="(e =>IncreaseQty())">
                        <i class="fa-solid fa-plus"></i>
                    </button>
                    <p class="button">
                        <a class="btn btn-primary" @onclick="(() => AddToCart(product))">Add To Cart</a>
                    </p>
                </div>
            </div>
        </div>
        <hr />
        <h2>Description</h2>
        <hr />
        <h4>@product.ShortDescription</h4>
        <p style="text-align:justify;">@product.LongDescription</p>

    </div>
</div>

@if (show)
{
    <div class="add-cart-success">
        <div class="alert-content">
            <p class="alert-info">Product successfully added to cart!</p>
            <a class="cart-link" href="/shoppingcart">View Cart</a>
        </div>
        <div class="alert-close">
            <p class="dismiss" @onclick="(() => CloseNotification())">x</p>
        </div>
    </div>
}


@code {

    [Parameter] public string Id { get; set; }

    Product product;

    protected override void OnInitialized()
    {
        product = _productRepository.GetProductById(int.Parse(Id));
    }

    void AddToCart(Product product)
    {
        show = _cart.AddToCart(product, productQty);
    }
}
