@using Microsoft.AspNetCore.Components.Web
@using Microsoft.AspNetCore.Components.Forms

@using Week8PicknPay.Repository
@using Week8PicknPay.Models

@inject IAddressRepository _addressRepo



    <EditForm Model="@AddressModel" OnValidSubmit="@HandleSubmit" class="">

        <DataAnnotationsValidator />
        <ValidationSummary />

        <div>
            <h5>Address Form</h5>
        </div>

        <div class="form-group">
            <label for="FirstName">First Name</label>
            <InputText id="FirstName" @bind-Value="AddressModel.FirstName" class="form-control" />
        </div>

        <div class="form-group">
            <label for="LastName">Last Name</label>
            <InputText id="LastName" @bind-Value="AddressModel.LastName" class="form-control" />
        </div>

        <div class="form-group">
            <label for="Phone">Phone Number</label>
            <InputText id="Phone" @bind-Value="AddressModel.PhoneNumber" class="form-control" />
        </div>

        <div class="form-group">
            <label for="HouseNo">House Number</label>
            <InputText id="HouseNo" @bind-Value="AddressModel.HouseNo" class="form-control" />
        </div>

        <div class="form-group">
            <label for="Street">Street</label>
            <InputText id="Street" @bind-Value="AddressModel.Street" class="form-control" />
        </div>

        <div class="form-group">
            <label for="City">City</label>
            <InputText id="City" @bind-Value="AddressModel.City" class="form-control" />
        </div>

        <div class="form-group">
            <label for="State">State</label>
            <InputText id="State" @bind-Value="AddressModel.State" class="form-control" />
        </div>

        <div class="form-group">
            <label for="LGA">LGA</label>
            <InputText id="LGA" @bind-Value="AddressModel.LGA" class="form-control" />
        </div>

        <div class="form-group">
            <button type="submit" class="btn btn-primary">Save</button>
        </div>

    </EditForm>



@if (show)
{
    <div class="alert alert-danger">
        <div>
            <p class="alert-info">Address has been successfully saved!</p>
        </div>
        <div>
            <a class="btn btn-primary" href="/order/checkout">Ok</a>
        </div>
    </div>
}





@code {

    [Parameter]
    public Order Order { get; set; }

    bool show = false;

    private Address AddressModel = new Address();

    private async Task HandleSubmit()
    {
        show = await _addressRepo.AddAddressAsync(AddressModel);
        if (show)
        {
            Order.Address = AddressModel;
        }
    }

}
